<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: List of Spectrum objects along with annotations</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body>

<table width="100%" summary="page for Spectra {MSnbase}"><tr><td>Spectra {MSnbase}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>List of Spectrum objects along with annotations</h2>

<h3>Description</h3>

<p><code>Spectra</code> objects allow to collect one or more <a href="Spectrum-class.html">Spectrum</a> object(s)
(<a href="Spectrum1-class.html">Spectrum1</a> or <a href="Spectrum2-class.html">Spectrum2</a>) in a <code>list</code>-like structure with
the possibility to add arbitrary annotations to each individual
<code>Spectrum</code> object. These can be accessed/set with the <code><a href="../../S4Vectors/html/Vector-class.html">mcols()</a></code> method.
</p>
<p><code>Spectra</code> objects can be created with the <code>Spectra</code> function.
</p>
<p>Functions to access the individual spectra's attributes are available
(listed below).
</p>
<p><code>writeMgfData</code> exports a <code>Spectra</code> object to a file in MGF format. All
metadata columns present in <code>mcols</code> are exported as additional fields with
the capitalized column names used as field names (see examples below).
</p>


<h3>Usage</h3>

<pre>
Spectra(..., elementMetadata = NULL)

## S4 method for signature 'Spectra'
mz(object)

## S4 method for signature 'Spectra'
intensity(object)

## S4 method for signature 'Spectra'
rtime(object)

## S4 method for signature 'Spectra'
precursorMz(object)

## S4 method for signature 'Spectra'
precursorCharge(object)

## S4 method for signature 'Spectra'
precScanNum(object)

## S4 method for signature 'Spectra'
precursorIntensity(object)

## S4 method for signature 'Spectra'
acquisitionNum(object)

## S4 method for signature 'Spectra'
scanIndex(object)

## S4 method for signature 'Spectra,ANY'
peaksCount(object)

## S4 method for signature 'Spectra'
msLevel(object)

## S4 method for signature 'Spectra'
tic(object)

## S4 method for signature 'Spectra'
ionCount(object)

## S4 method for signature 'Spectra'
collisionEnergy(object)

## S4 method for signature 'Spectra'
fromFile(object)

## S4 method for signature 'Spectra'
polarity(object)

## S4 method for signature 'Spectra'
smoothed(object)

## S4 method for signature 'Spectra'
isEmpty(x)

## S4 method for signature 'Spectra'
centroided(object)

## S4 method for signature 'Spectra'
isCentroided(object)

## S4 method for signature 'Spectra'
writeMgfData(object, con = "spectra.mgf",
  COM = NULL, TITLE = NULL)

## S4 method for signature 'Spectra'
clean(object, all = FALSE, msLevel. = msLevel.,
  ...)

## S4 method for signature 'Spectra'
removePeaks(object, t, msLevel., ...)

## S4 method for signature 'Spectra'
filterMz(object, mz, msLevel., ...)

## S4 method for signature 'Spectra'
pickPeaks(object, halfWindowSize = 3L,
  method = c("MAD", "SuperSmoother"), SNR = 0L, refineMz = c("none",
  "kNeighbors", "kNeighbours", "descendPeak"),
  msLevel. = unique(msLevel(object)), ...)

## S4 method for signature 'Spectra'
smooth(x, method = c("SavitzkyGolay",
  "MovingAverage"), halfWindowSize = 2L, ...)

## S4 method for signature 'Spectra'
filterMsLevel(object, msLevel.)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>...</code></td>
<td>
<p>For <code>Spectra</code>: <a href="Spectrum-class.html">Spectrum</a> object(s) or a <code>list</code> of
<a href="Spectrum-class.html">Spectrum</a> objects.
For all other methods optional arguments passed along.</p>
</td></tr>
<tr valign="top"><td><code>elementMetadata</code></td>
<td>
<p>For <code>Spectra</code>: <a href="../../MultiAssayExperiment/html/reexports.html">DataFrame</a> with optional information
that should be added as metadata information (<code>mcols</code>) to the object.
The number of rows has to match the number of <a href="Spectrum-class.html">Spectrum</a> objects,
each row is expected to represent additional metadata information for
one spectrum.</p>
</td></tr>
<tr valign="top"><td><code>object</code></td>
<td>
<p>For all functions: a <code>Spectra</code> object.</p>
</td></tr>
<tr valign="top"><td><code>x</code></td>
<td>
<p>For all functions: a <code>Spectra</code> object.</p>
</td></tr>
<tr valign="top"><td><code>con</code></td>
<td>
<p>For <code>writeMgfData</code>: <code>character(1)</code> defining the file name of
the MGF file.</p>
</td></tr>
<tr valign="top"><td><code>COM</code></td>
<td>
<p>For <code>writeMgfData</code>: optional <code>character(1)</code> providing a comment
to be added to the file.</p>
</td></tr>
<tr valign="top"><td><code>TITLE</code></td>
<td>
<p>For <code>writeMgfData</code>: optional <code>character(1)</code> defining the title
for the MGF file.</p>
</td></tr>
<tr valign="top"><td><code>all</code></td>
<td>
<p>For <code>clean</code>: if <code>FALSE</code> original 0-intensity values are retained
around peaks.</p>
</td></tr>
<tr valign="top"><td><code>msLevel.</code></td>
<td>
<p>For <code>clean</code>, <code>removePeaks</code>, <code>filterMz</code>, <code>pickPeaks</code>:
optionally specify the MS level(s) of the spectra on which the operation
should be performed.
For <code>filterMsLevels</code>: MS level(s) to which the <code>Spectra</code> should be reduced.</p>
</td></tr>
<tr valign="top"><td><code>t</code></td>
<td>
<p>For <code>removePeaks</code>: <code>numeric(1)</code> specifying the threshold below
which intensities are set to 0.</p>
</td></tr>
<tr valign="top"><td><code>mz</code></td>
<td>
<p>For <code>filterMz</code>: <code>numeric(2)</code> defining the lower and upper m/z
for the filter. See <code><a href="trimMz-methods.html">filterMz()</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>halfWindowSize</code></td>
<td>
<p>For <code>pickPeaks</code> and <code>smooth</code>: see <code><a href="pickPeaks-method.html">pickPeaks()</a></code>
and <code><a href="smooth-methods.html">smooth()</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>For <code>pickPeaks</code> and <code>smooth</code>: see <code><a href="pickPeaks-method.html">pickPeaks()</a></code> and <code><a href="smooth-methods.html">smooth()</a></code>
for details.</p>
</td></tr>
<tr valign="top"><td><code>SNR</code></td>
<td>
<p>For <code>pickPeaks</code>: see <code><a href="pickPeaks-method.html">pickPeaks()</a></code> for details.</p>
</td></tr>
<tr valign="top"><td><code>refineMz</code></td>
<td>
<p>For <code>pickPeaks</code>: see <code><a href="pickPeaks-method.html">pickPeaks()</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Spectra</code> inherits all methods from the <a href="../../S4Vectors/html/SimpleList-class.html">SimpleList</a> class of the
<code>S4Vectors</code> package. This includes <code>lapply</code> and other data manipulation
and subsetting operations.
</p>


<h3>Constructor</h3>

<p>New <a href="Spectra.html">Spectra</a> can be created with the <code>Spectra(...)</code> function
where <code>...</code> can either be a single <a href="Spectrum-class.html">Spectrum</a> object or a <code>list</code> of
<code>Spectrum</code> objects (<a href="Spectrum1-class.html">Spectrum1</a> and/or <a href="Spectrum2-class.html">Spectrum2</a>).
</p>


<h3>Accessing spectrum attributes</h3>

<p>These methods allow to access the attributes and values of the individual
<code>Spectrum</code> (<a href="Spectrum1-class.html">Spectrum1</a> or <a href="Spectrum2-class.html">Spectrum2</a>) objects within the list.
</p>

<ul>
<li> <p><code>mz</code> return the m/z values of each spectrum as a <code>list</code> of <code>numeric</code>
vectors.
</p>
</li>
<li> <p><code>intensity</code> return the intensity values of each spectrum as a <code>list</code> of
<code>numeric</code> vectors.
</p>
</li>
<li> <p><code>rtime</code> return the retention time of each spectrum as a <code>numeric</code> vector
with length equal to the length of <code>object</code>.
</p>
</li>
<li> <p><code>precursorMz</code>, <code>precursorCharge</code>, <code>precursorIntensity</code>, <code>precScanNum</code>
return precursor m/z values, charge, intensity and scan number for each
spectrum as a <code>numeric</code> (or <code>integer</code>) vector with length equal to the
length of <code>object</code>. Note that for <a href="Spectrum1-class.html">Spectrum1</a> objects <code>NA</code> will be
returned.
</p>
</li>
<li> <p><code>acquisitionNum</code> and <code>scanIndex</code> return the acquisition number of each
spectrum and its scan index as an <code>integer</code> vector with the same length
than <code>object</code>.
</p>
</li>
<li> <p><code>ionCount</code> and <code>tic</code> return the ion count and total ion current of each
spectrum.
</p>
</li>
<li> <p><code>peaksCount</code> returns the number of peaks for each spectrum as a <code>integer</code>
vector.
</p>
</li>
<li> <p><code>msLevel</code> returns the MS level of each spectrum.
</p>
</li>
<li> <p><code>collisionEnergy</code> returns the collision energy for each spectrum or <code>NA</code>
for <a href="Spectrum1-class.html">Spectrum1</a> objects.
</p>
</li>
<li> <p><code>polarity</code> returns the spectra's polarity.
</p>
</li>
<li> <p><code>fromFile</code> returns the index from the (e.g. mzML) file the spectra where
from. This applies only for spectra read using the <code><a href="readMSData.html">readMSData()</a></code> function.
</p>
</li>
<li> <p><code>smoothed</code> whether spectra have been smoothed (i.e. processed with the
<code><a href="smooth-methods.html">smooth()</a></code> method. Returns a <code>logical</code> of length equal to the
number of spectra.
</p>
</li>
<li> <p><code>isEmpty</code> returns <code>TRUE</code> for spectra without peak data.
</p>
</li>
<li> <p><code>centroided</code>, <code>isCentroided</code> returns for each spectrum whether it contains
<em>centroided</em> data. While <code>centroided</code> returns the internal attribute of
each spectrum, <code>isCentroided</code> tries to guess whether spectra are
centroided from the actual peak data.
</p>
</li></ul>



<h3>Data manipulation methods</h3>


<ul>
<li> <p><code>clean</code> <em>cleans</em> each spectrum. See <code><a href="clean-methods.html">clean()</a></code> for more details.
</p>
</li>
<li> <p><code>pickPeaks</code> performs peak picking to generate centroided spectra. See
<code><a href="pickPeaks-method.html">pickPeaks()</a></code> for more details.
</p>
</li>
<li> <p><code>removePeaks</code> removes peaks lower than a threshold <code>t</code>. See
<code><a href="removePeaks-methods.html">removePeaks()</a></code> for more details.
</p>
</li>
<li> <p><code>smooth</code> <em>smooths</em> spectra. See <code><a href="smooth-methods.html">smooth()</a></code> for more details.
</p>
</li></ul>



<h3>Filtering and subsetting</h3>


<ul>
<li> <p><code>[</code> can be used to subset the <code>Spectra</code> object.
</p>
</li>
<li> <p><code>filterMsLevel</code> filters <code>Spectra</code> to retain only spectra from certain MS
level(s).
</p>
</li>
<li> <p><code>filterMz</code> filters the spectra by the specified <code>mz</code> range. See
<code><a href="trimMz-methods.html">filterMz()</a></code> for details.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Johannes Rainer
</p>


<h3>Examples</h3>

<pre>

## Create from Spectrum objects
sp1 &lt;- new("Spectrum1", mz = c(1, 2, 4), intensity = c(4, 5, 2))
sp2 &lt;- new("Spectrum2", mz = c(1, 2, 3, 4), intensity = c(5, 3, 2, 5),
    precursorMz = 2)

spl &lt;- Spectra(sp1, sp2)
spl
spl[[1]]

## Add also metadata columns
mcols(spl)$id &lt;- c("a", "b")
mcols(spl)

## Create a Spectra with metadata
spl &lt;- Spectra(sp1, sp2, elementMetadata = DataFrame(id = c("a", "b")))

mcols(spl)
mcols(spl)$id

## Extract the mz values for the individual spectra
mz(spl)

## Extract the intensity values for the individual spectra
intensity(spl)

## Extract the retention time values for the individual spectra
rtime(spl)

## Extract the precursor m/z of each spectrum.
precursorMz(spl)

## Extract the precursor charge of each spectrum.
precursorCharge(spl)

## Extract the precursor scan number for each spectrum.
precScanNum(spl)

## Extract the precursor intensity of each spectrum.
precursorIntensity(spl)

## Extract the acquisition number of each spectrum.
acquisitionNum(spl)

## Extract the scan index of each spectrum.
scanIndex(spl)

## Get the number of peaks per spectrum.
peaksCount(spl)

## Get the MS level of each spectrum.
msLevel(spl)

## Get the total ion current for each spectrum.
tic(spl)

## Get the total ion current for each spectrum.
ionCount(spl)

## Extract the collision energy for each spectrum.
collisionEnergy(spl)

## Extract the file index for each spectrum.
fromFile(spl)

## Get the polarity for each spectrum.
polarity(spl)

## Whether spectra are smoothed (i.e. processed with the `smooth`
## function).
smoothed(spl)

## Are spectra empty (i.e. contain no peak data)?
isEmpty(spl)

## Do the spectra contain centroided data?
centroided(spl)

## Do the spectra contain centroided data? Whether spectra are centroided
## is estimated from the peak data.
isCentroided(spl)

## Export the spectrum list to a MGF file. Values in metadata columns are
## exported as additional field for each spectrum.
tmpf &lt;- tempfile()
writeMgfData(spl, tmpf)

## Evaluate the written output. The ID of each spectrum (defined in the
## "id" metadata column) is exported as field "ID".
readLines(tmpf)

## Set mcols to NULL to avoid export of additional data fields.
mcols(spl) &lt;- NULL
file.remove(tmpf)

writeMgfData(spl, tmpf)
readLines(tmpf)

## Filter the object by MS level
filterMsLevel(spl, msLevel. = 1)
</pre>

<hr /><div style="text-align: center;">[Package <em>MSnbase</em> version 2.12.0 <a href="00Index.html">Index</a>]</div>
</body></html>
